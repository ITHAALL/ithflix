{% extends "base.html" %}
{% block title %}Films — ITH-Hub{% endblock %}

{% block content %}
<!-- Hero -->
<section class="hero">
  <div class="hero-content">
    <h1 class="hero-title animate-in">
      Films &amp;<br>
      <span class="highlight">Séries</span>
    </h1>
    <p class="hero-subtitle animate-in delay-1">
      Regardez vos films préférés sans pub, sans inscription supplémentaire.
    </p>
    <a href="#catalogue" class="hero-cta animate-in delay-2">
      Voir le catalogue
      <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M5 12h14M12 5l7 7-7 7"/>
      </svg>
    </a>
  </div>
  <div class="hero-decoration">
    <div class="deco-circle"></div>
    <div class="deco-circle"></div>
    <div class="deco-circle"></div>
  </div>
</section>

<!-- Admin toolbar -->
{% if session.get('is_admin') %}
<div style="padding: 0 40px 0; display:flex; justify-content:flex-end;">
  <a href="{{ url_for('add_movie') }}" style="
    display:inline-flex;align-items:center;gap:8px;
    background:var(--red);color:white;
    padding:9px 18px;border-radius:var(--radius-sm);
    font-size:0.82rem;font-weight:600;
    transition:var(--transition);
  ">
    <i class="fa-solid fa-plus"></i> Ajouter un film
  </a>
</div>
{% endif %}

<!-- Catalogue -->
<section id="catalogue">
  <div class="section-header">
    <h2 class="section-title">Catalogue Films</h2>
    <div class="title-underline"></div>
  </div>

  {% if movies %}
  <div class="movies-grid">
    {% for m in movies %}
    <div style="position:relative;">
      {% if session.get('is_admin') %}
      <div class="badge-admin">
        <a href="{{ url_for('edit_movie', id=m['_id']|string) }}" class="admin-btn" title="Modifier">
          <i class="fa-solid fa-pen"></i>
        </a>
        <a href="{{ url_for('delete_movie', id=m['_id']|string) }}"
           class="admin-btn delete" title="Supprimer"
           onclick="return confirm('Supprimer ce film ?')">
          <i class="fa-solid fa-trash"></i>
        </a>
      </div>
      {% endif %}
      {% if loop.first %}<div class="badge-new">Nouveau</div>{% endif %}

      <a href="{{ url_for('watch_movie', movie_id=m['_id']|string) }}" class="movie-card">
        <div class="movie-cover">
          <img src="{{ m.cover }}" alt="{{ m.title }}" loading="lazy">
          <div class="movie-overlay">
            <span class="play-icon">
              <svg width="22" height="22" viewBox="0 0 24 24" fill="currentColor">
                <path d="M8 5v14l11-7z"/>
              </svg>
            </span>
          </div>
        </div>
        <div class="movie-info-bottom">
          <h3 class="movie-title">{{ m.title|flag_title }}</h3>
        </div>
      </a>
    </div>
    {% endfor %}
  </div>

  {% else %}
  <div class="empty-state">
    <i class="fa-solid fa-film" style="font-size:3rem;opacity:.2;"></i>
    <h3>Aucun film disponible</h3>
    <p>Le catalogue est vide pour l'instant.</p>
  </div>
  {% endif %}
</section>
{% endblock %}
